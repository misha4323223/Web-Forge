Понял! Для продакшена на Яндекс Cloud нужно сохранить credentials в переменных окружения Cloud Function. Сейчас создам систему авторизации, которая работает и в Replit (для разработки), и в Yandex Cloud (для продакшена).

I need to implement authentication for the admin panel. For Yandex Cloud deployment, the credentials will be stored in Cloud Function environment variables. For Replit development, they'll be in secrets.

The approach:

Create a login page/state in Admin.tsx
Add an auth endpoint in server/routes.ts
Use session-based auth or simple token-based auth
Since it's a static site deployed to Yandex Object Storage, the auth needs to work client-side with the Cloud Function validating credentials. Let me implement:

A login form in Admin.tsx that shows before the admin content
Store auth state in localStorage/sessionStorage
Backend endpoint to validate credentials
For simplicity and security, I'll:

Add login state to Admin.tsx with a login form
Call Cloud Function to validate credentials
Store session token in sessionStorage
Создам защиту админки с формой входа. Credentials будут проверяться через Cloud Function (для продакшена на Яндекс Cloud).

I need to add an authentication layer to the Admin page. I'll:

Add isAuthenticated state
Create a login form
Check credentials against environment variables4. Store auth token in sessionStorage
Let me read more of the Admin.tsx file to see where the main content starts, then add the auth logic.

Now I understand the structure of Admin.tsx. I need to add authentication before showing the content. I'll:1. Add isAuthenticated state (check sessionStorage on load)2. Add login form at the beginning3. If not authenticated, show login form; otherwise, show the admin content4. Add API endpoint for login validationLet me now modify Admin.tsx to add authentication. I'll add a login form component before the main content.

-2
+2
-1
+1
import { useState } from "react";
import { useState, useEffect } from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { useMutation, useQuery } from "@tanstack/react-query";
-1
+1
import { Badge } from "@/components/ui/badge";
import { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from "@/components/ui/alert-dialog";
import { Loader2, Copy, Check, Trash2, Edit2, Mail, Phone, Calendar, StickyNote, Building2, CreditCard, FileText, CheckCircle } from "lucide-react";
import { Loader2, Copy, Check, Trash2, Edit2, Mail, Phone, Calendar, StickyNote, Building2, CreditCard, FileText, CheckCircle, Lock, LogOut, Eye, EyeOff } from "lucide-react";
import { useToast } from "@/hooks/use-toast";
type AdditionalInvoiceFormData = {
Теперь добавлю логику авторизации в компонент:

-0
+69
-0
+69
  const [orderToDelete, setOrderToDelete] = useState<Order | null>(null);
  const [noteText, setNoteText] = useState("");
  const [activeTab, setActiveTab] = useState("orders");

  const [isAuthenticated, setIsAuthenticated] = useState(false);
  const [loginEmail, setLoginEmail] = useState("");
  const [loginPassword, setLoginPassword] = useState("");
  const [showPassword, setShowPassword] = useState(false);
  const [loginLoading, setLoginLoading] = useState(false);
  const [authChecking, setAuthChecking] = useState(true);
  const API_BASE_URL = import.meta.env.VITE_API_URL || "https://functions.yandexcloud.net/d4ed08qj9rekklj8b100";

  useEffect(() => {
    const token = sessionStorage.getItem("adminToken");
    if (token) {
Теперь добавлю интерфейс входа. Найду место где начинается return:

-1
+94
-1
+94
    toast({ title: "ID скопирован!", description: orderId });
  };
  if (authChecking) {
    return (
      <div className="min-h-screen bg-background text-foreground flex items-center justify-center">
        <Loader2 className="w-8 h-8 animate-spin text-cyan-400" />
      </div>
    );
  }
  if (!isAuthenticated) {
    return (
      <div className="min-h-screen bg-background text-foreground">
        <Navigation />
        <main className="pt-24 pb-16">
Отлично! Теперь добавлю обработку авторизации в Cloud Function. Сначала проверю текущую структуру:

I need to add admin authentication to the Cloud Function. The token in sessionStorage is not ideal but for a static site it's a practical solution. I'll:1. Create a secure token by hashing credentials + timestamp2. Set a short expiration on the token (1 hour)3. Verify the token on each API call

Let me add the admin-login and verify-admin handlers to the Cloud Function. I'll also add ADMIN_EMAIL and ADMIN_PASSWORD as environment variables that will need to be configured in Yandex Cloud.

Now I need to add the admin authentication handlers. Let me add them after the existing routes.

-0
+9
-0
+9
        const actionOrderMa...